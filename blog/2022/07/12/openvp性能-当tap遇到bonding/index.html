<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" /> 
    <title>OpenVP性能 当tap遇到bonding - Golang编程语言知识介绍</title>
    <meta name="keywords" content="git,Git,Lua,lua,Golang,go">
    
    <meta property="og:title" content="OpenVP性能 当tap遇到bonding">
    <meta property="og:site_name" content="Golang编程语言知识介绍">
    <meta property="og:image" content="/img/author.jpg"> 
    <meta name="title" content="OpenVP性能 当tap遇到bonding - Golang编程语言知识介绍" />
    <meta name="description" content="愿星光伴你左右"> 
    <link rel="shortcut icon" href="http://shanks.link/img/favicon.ico" />
    <link rel="apple-touch-icon" href="http://shanks.link/img/apple-touch-icon.png" />
    <link rel="apple-touch-icon-precomposed" href="http://shanks.link/img/apple-touch-icon.png" />
    <link href="http://shanks.link/js/vendor/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />
    <link href="http://shanks.link/js/vendor/fancybox/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />
    <link href="http://shanks.link/css/main.css" rel="stylesheet" type="text/css" />
    <link href="http://shanks.link/css/syntax.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
     fancybox: true, 
    motion: true
  };
</script>
</head>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">
<div class="container one-collumn sidebar-position-left page-home  ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-meta  custom-logo ">

  <div class="custom-logo-site-title">
    <a href="http://shanks.link/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Golang编程语言知识介绍</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
    <ul id="menu" class="menu">
      
      
        <li class="menu-item ">
          <a href="http://shanks.link/post/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/thinking/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />随想录
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/%E7%94%9F%E6%B4%BB/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />生活
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/os/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />OS
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/lua/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />lua
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/redis/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />redis
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/go/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />Golang
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/c/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />C
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/tcpip/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />TCP/IP
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/ebpf/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />ebpf
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/p4/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />p4
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/openvpn/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />OpenVPN
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/ipsec/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />IPSec
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/l2tp/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />L2TP
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/dns/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />DNS
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/web/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />web
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/openwrt/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />OpenWRT
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/%E8%BF%90%E7%BB%B4/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />运维
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/git/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />Git
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/%E9%B8%9F%E5%93%A5%E7%9A%84%E7%A7%81%E6%88%BF%E8%8F%9C/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />鸟哥的私房菜
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/categories/it/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />IT杂谈
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/about/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />About Me
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/links/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />友情链接
          </a>
        </li>
      
        <li class="menu-item ">
          <a href="http://shanks.link/ftp/" rel="section">
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />FTP
          </a>
        </li>
      
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger"> <i class="menu-item-icon fa fa-search fa-fw"></i> <br /> 搜索</a>
      </li>
    </ul>
    <div class="site-search">
      <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>

    </div>
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
<section id="posts" class="posts-expand">
  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
      <h1 class="post-title" itemprop="name headline">
        <a class="post-title-link" href="http://shanks.link/blog/2022/07/12/openvp%E6%80%A7%E8%83%BD-%E5%BD%93tap%E9%81%87%E5%88%B0bonding/" itemprop="url">
        OpenVP性能 当tap遇到bonding
        </a>
      </h1>
      <div class="post-meta">
      <span class="post-time">
<span class="post-meta-item-icon">
    <i class="fa fa-calendar-o"></i>
</span>
<span class="post-meta-item-text">时间：</span>
<time itemprop="dateCreated" datetime="2016-03-22T13:04:35+08:00" content="2022-07-12">
    2022-07-12
</time>
</span> 
      

  <span class="post-category" >
  &nbsp; | &nbsp;
  <span class="post-meta-item-icon">
    <i class="fa fa-folder-o"></i>
  </span>
  <span class="post-meta-item-text">分类：</span>
  
    <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
      <a href="http://shanks.link/categories/openvpn" itemprop="url" rel="index">
        <span itemprop="name">openvpn</span>
      </a>
      &nbsp; 
    </span>
  
</span>


       <span>
&nbsp; | &nbsp;
<span class="post-meta-item-icon">
    <i class="fa fa-eye"></i>
</span>
<span class="post-meta-item-text">阅读：</span>
<span class="leancloud-visitors-count">3004 字 ~6分钟</span>
</span>
      </div>
    </header>
    <div class="post-body" itemprop="articleBody">
    <h1 id="引子">引子</h1>
<p>​		别的就不多说什么了，前面的文章说过，OpenVPN有两个瓶颈，一个是tap网卡，另一个是加密/解密 ，然而不可否认，OpenVPN的客户端和服务器端处于一个“虚拟网段”，抛开虚拟不谈，只要是一个网段的，我们就可以说它们属于一个局域网(当然前提是使用tcp/ip网络)，既然属于一个局域网，那么它要么是广播的，要么是点对点的，不管怎样，两端都有确定的三层地址(IP地址)，所有的数据包都是通过这个三层地址来传输到对端的，因此为了使得路径畅通，我们只关心路由即可。</p>
<p>​		既然是链路层网络(即使它是虚拟的，我们称为<strong>EoTAP-Ethernet Over Tap</strong>) ，我们就可以使用链路层的端口聚合来增加带宽或者加强稳定性，类似一个局域以太网的两台机器可以直连或者通过交换机间接相连，OpenVPN的服务器和客户端也可以被认为是通过tap网卡连接的“虚拟局域网”，那么它们之间的连接也可以使用端口聚合。</p>
<p>​		对于OpenVPN来讲，VPN链路的“虚拟物理链路”其实就是两个OpenVPN进程(OpenVPN客户端和服务器)之间的真实物理链路(我们知道，从tap网卡发出的数据进入了tap字符设备，然后进入OpenVPN进程，随着OpenVPN进程间的真实物理链路到达对端，然后进入tap字符设备，最终被tap接收&hellip;)，因此我们完全可以将4个OpenVPN进程绑成两个虚拟链路通道。</p>
<p>​		对于负载均衡策略来讲，同一链路层(不管是点对点网络还是广播网络)网段使用端口聚合的方式，而网络层的负载均衡需要使用分割网段的方式。对于OpenVPN连接的两端，不管它们跨越了多少物理链路层网段，由于存在于同一个虚拟链路层网段，它们就适合用端口聚合的方式进行负载均衡，这里的“端口”就是OpenVPN进程。</p>
<p>​		如果你的机器拥有16核的cpu或者16个cpu以及8257X或者8259X的网卡芯片，对端也拥有同样的配置，仅开启一对OpenVPN进程的话，大量的资源将被无情浪费，这是OpenVPN本身造成的，它是单进程单线程程序，无法利用多核cpu，tap网卡一帧一帧的处理方式和物理网卡芯片的能力严重不匹配，由于tap的处理方式，物理网卡也要一帧一帧发送(这些帧和tap出来的帧的区别仅仅在于它将数据加密处理后加了一层tcp/ip协议栈的封装)，因此何不启用16对OpenVPN进程，一个cpu上绑一个，然后在每一端将16个OpenVPN进程打开的tap网卡全部绑定在一起，这样不就相当于16个端口聚和了吗？</p>
<h1 id="环境">环境</h1>
<h2 id="服务器端的openvpn配置文件server12cfg">服务器端的OpenVPN配置文件server1/2.cfg：</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dev tun
proto tcp 
tls-server
cipher BF-CBC
keepalive 10 60
mode server
server 172.16.0.0 255.255.0.0
local 0.0.0.0
lport 1194
dh dh1024.pem.dh
ca ca.pem
cert server.pem
key  server.key 
</code></pre></div><p>配置文件2仅将lport改为1195即可</p>
<h2 id="2-客户端openvpn配置文件client12cfg">2. 客户端OpenVPN配置文件client1/2.cfg：</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">client
float
dev tun
proto tcp
remote 192.168.1.22 1194
ca ca.pem
cert client.pem
key  client.key
cipher BF-CBC
</code></pre></div><p>配置文件2仅将remote的端口改为1195即可</p>
<h2 id="内核为2632bonding支持sysfs的配置方式">内核为2.6.32，bonding支持sysfs的配置方式</h2>
<h2 id="备注">备注：</h2>
<h3 id="之所以使用tun模式而不是tap模式是因为openvpn服务器进程作为一个虚拟的交换机对arp有所过滤因此需要修改一些openvpn的代码后才能更好更稳定的支持bonding否则只能使用bonding的active-backup模式且fail_over_mac参数也要设置tun模式就不存在这个问题它不发arp只是点对点有路由即可">之所以使用tun模式而不是tap模式是因为OpenVPN服务器进程作为一个虚拟的交换机对arp有所过滤，因此需要修改一些OpenVPN的代码后才能更好更稳定的支持bonding，否则只能使用bonding的active-backup模式，且fail_over_mac参数也要设置。tun模式就不存在这个问题，它不发arp，只是点对点，有路由即可。</h3>
<h3 id="多个openvpn服务器的虚拟ip必须一致且保证这些openvpn服务器一对一的分配给同一台机器的所有openvpn客户端的虚拟也必须一致因为openvpn服务器要验证客户端ip地址的bonding了之后所有的客户端将统一于唯一的一个ip地址">多个OpenVPN服务器的虚拟ip必须一致，且保证这些OpenVPN服务器一对一的分配给同一台机器的所有OpenVPN客户端的虚拟也必须一致，因为OpenVPN服务器要验证客户端ip地址的，bonding了之后，所有的客户端将统一于唯一的一个ip地址。</h3>
<h3 id="为何使用2632的内核实际上如果使用268这么老的内核用本文的方式是配不通的因为老的内核没有使用sysfs配置bonding而是使用了ioctl这样的话由于tap网卡驱动不支持bonding相关的ioctl参数那一切都是没有意义这里也体现了ioctl地狱是真实存在的需要各方面联合才行为了支持bonding不得不修改tap驱动增加其ioctl参数">为何使用2.6.32的内核，实际上如果使用2.6.8这么老的内核用本文的方式是配不通的，因为老的内核没有使用sysfs配置bonding，而是使用了ioctl，这样的话，由于tap网卡驱动不支持bonding相关的ioctl参数，那一切都是没有意义，这里也体现了ioctl地狱是真实存在的。需要各方面联合才行，为了支持bonding，不得不修改tap驱动，增加其ioctl参数。</h3>
<h1 id="配置">配置</h1>
<h2 id="在服务器上启动两个openvpn">在服务器上启动两个OpenVPN：</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@zyxx:~/vpn# openvpn --config server1.cfg
root@zyxx:~/vpn# openvpn --config server2.cfg 
复制代码
</code></pre></div><h2 id="在客户端上启动两个openvpn">在客户端上启动两个OpenVPN：</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@zyxx:~/vpn# openvpn --config client1.cfg
root@zyxx:~/vpn# openvpn --config client2.cfg 
复制代码
</code></pre></div><h2 id="配置服务器端bonding">配置服务器端bonding：</h2>
<h3 id="载入bonding模块">载入bonding模块</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@zyxx:~/vpn#modprobe bonding 
复制代码
</code></pre></div><h3 id="配置bond0">配置bond0：</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@zyxx:~/vpn#echo +bond0 &gt; /sys/class/net/bonding_masters 
复制代码
</code></pre></div><h3 id="首先down掉所有的tap网卡">首先down掉所有的tap网卡：</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@zyxx:~/vpn# ifconfig tun0 down
root@zyxx:~/vpn# ifconfig tun1 down 
复制代码
</code></pre></div><h3 id="将所有的tap网卡加入bond0">将所有的tap网卡加入bond0：</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@zyxx:~/vpn# echo +tun0 &gt; /sys/class/net/bond0/bonding/slaves 
root@zyxx:~/vpn# echo +tun1 &gt; /sys/class/net/bond0/bonding/slaves 
复制代码
</code></pre></div><h3 id="配置mode及miimon链路检测">配置mode及miimon链路检测：</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@zyxx:~/vpn# echo 0 &gt; /sys/class/net/bond0/bonding/mode 
root@zyxx:~/vpn# echo 100 &gt; /sys/class/net/bond0/bonding/miimon 
复制代码
</code></pre></div><p>将mode设置成了简单round-robin负载均衡模式。</p>
<h3 id="配置bond0的ip">配置bond0的ip：</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@zyxx:~/vpn# ifconfig bond0 172.16.0.1/16 
复制代码
</code></pre></div><h3 id="删除冲突路由仅仅保留bond0的路由">删除冲突路由，仅仅保留bond0的路由：</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@zyxx:~/vpn# route del -host 172.16.0.2 dev tun0
root@zyxx:~/vpn# route del -host 172.16.0.2 dev tun1
root@zyxx:~/vpn# route del -host 172.16.0.6 dev tun0
root@zyxx:~/vpn# route del -host 172.16.0.6 dev tun1
root@zyxx:~/vpn# route add -host 172.16.0.6 dev bond0 
复制代码
</code></pre></div><p>这里假设分配给拥有client.pem这个证书的客户端的ip是172.16.0.6</p>
<h3 id="ok">OK</h3>
<h2 id="配置客户端的bonding">配置客户端的bonding：</h2>
<p>同3</p>
<h1 id="感受">感受</h1>
<ol>
<li>和没有使用bonding相比，找一个测速工具看一下通过bonding之后的OpenVPN是否速度加倍了，答案是效果可能不明显；</li>
<li>效果不明显可能因为你的机器配置不是很好，OpenVPN并没有明显的降速，也就是说，通过OpenVPN链路和通过物理链路的速率相差不大。那样的话就在客户端启动的时候加上&ndash;shape参数，手工将单个OpenVPN虚拟链路的速率降低，这样效果就明显了；</li>
<li>我使用：openvpn &ndash;config client1/2.cfg &ndash;shaper 5000启动OpenVPN客户端，wget的速率达到了6k/s左右(OpenVPN服务器和客户端之间属于不同的VLAN)，而使用单个OpenVPN链路的话速率仅仅是2.5k~3k/s左右。</li>
<li>目前OpenVPN还不支持直接配置bonding，期待有人做相关的修改，使之可以bonding。这个修改很简单，不需要修改驱动，其实只需要将上述的配置过程写成自动化的即可，也就是增加几个参数的工作量，如果有人觉得有趣，不妨试一下，如果没有人试，没有人试就算了&hellip;</li>
</ol>
<h1 id="后记">后记</h1>
<p>前一段时间，工作原因需要测试OpenVPN的性能，我对此工作任务非常感兴趣，期待最终能得到一个结果，虽然我对OpenVPN的ssl+tap架构十分满意，然而却对它的单线程架构，每帧传输实在不敢恭维，多核当道的今天，网卡芯片普遍offload的今天，OpenVPN好像是十几年前的家伙&hellip;</p>
<p>我并不期待得到的结果一定是好的，实际上我需要的quick success或者quick failure，二者都令我满意，最重要的是在工作过程中得到了锻炼，这个过程不管对个人还是对公司都是一个很有意义的东西。期间，我百度，google了很多资料，大多数都是关于OpenVPN本身参数配置的，很少有关于修改tap驱动在降低些许延迟的小代价下提高吞吐量的，也几乎没有将tap网卡做bonding的，甚至连加密算法对OpenVPN性能的影响的资料都是少之又少，因此我就我的经验写了几篇文章，发表在CSDN上，这几篇文章都是以《OpenVPN性能》 为主标题，副标题根据文章内容而变化，分享给需要的人们，希望以后有谁遇到类似的问题再google和百度的时候，能得到一些新鲜的东西 。</p>
<p><a href="https://juejin.cn/post/6844903737601818631">以上内容转载自笑叶林的blog</a></p>

    </div>
    <footer class="post-footer">
     
 
<div class="post-tags">     
     
    <a href="http://shanks.link/tags/openvpn" rel="tag" title="openvpn">#openvpn#</a>
    
</div>



     <div class="post-nav">
    <div class="post-nav-next post-nav-item">
    
        <a href="http://shanks.link/blog/2022/07/12/%E8%BF%94%E7%92%9E%E5%BD%92%E7%9C%9F%E5%AE%9E%E7%8E%B0openvpn%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5%E5%8D%8F%E5%95%86/" rel="next" title="返璞归真实现OpenVPN第二阶段协商">
        <i class="fa fa-chevron-left"></i> 返璞归真实现OpenVPN第二阶段协商
        </a>
    
    </div>

    <div class="post-nav-prev post-nav-item">
    
        <a href="http://shanks.link/blog/2022/07/12/openvpn%E6%80%A7%E8%83%BD-%E7%AC%AC%E4%BA%8C%E4%B8%AA%E7%93%B6%E9%A2%88%E5%9C%A8ssl%E5%8A%A0%E8%A7%A3%E5%AF%86/" rel="prev" title="OpenVPN性能 第二个瓶颈在ssl加解密">
        OpenVPN性能 第二个瓶颈在ssl加解密 <i class="fa fa-chevron-right"></i>
        </a>
    
    </div>
</div>
      
     
     
     





<script src="https://utteranc.es/client.js"
        repo="shankusu2017@gmail.com/"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
<noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

    </footer>
  </article>
</section>

          </div>
        </div>
        <div class="sidebar-toggle">
  <div class="sidebar-toggle-line-wrap">
    <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
    <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
  </div>
</div>
<aside id="sidebar" class="sidebar">
  <div class="sidebar-inner">

    <section class="site-overview sidebar-panel  sidebar-panel-active ">
      <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image"
        src="http://shanks.link/img/logo.jpg"
        alt="shankusu2017@gmail.com" />
    <p class="site-author-name" itemprop="name">shankusu2017@gmail.com</p>
    <p class="site-description motion-element" itemprop="description"> </p>
</div>
      <nav class="site-state motion-element">
    <div class="site-state-item site-state-posts">
      <a href="http://shanks.link/post/">
        <span class="site-state-item-count">569</span>
        <span class="site-state-item-name">日志</span>
      </a>
    </div>
    <div class="site-state-item site-state-categories">    
        <a href="http://shanks.link/categories/">      
         
        <span class="site-state-item-count">45</span>
        
        <span class="site-state-item-name">分类</span>
        
        </a>
    </div>

    <div class="site-state-item site-state-tags">
        <a href="http://shanks.link/tags/">
         
        <span class="site-state-item-count">50</span>
        
        <span class="site-state-item-name">标签</span>
        </a>
    </div>
</nav>
      
      
<div class="links-of-author motion-element">
    
        <span class="links-of-author-item">
        <a href="https://github.com/shankusu2017" target="_blank" title="GitHub">
            <i class="fa fa-fw fa-github"></i>
            GitHub
        </a>
        </span>
    
</div>


      

      <div class="links-of-blogroll motion-element inline">
<script type="text/javascript" src="//rf.revolvermaps.com/0/0/8.js?i=5b4f2ucxar6&amp;m=0&amp;s=220&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=33&amp;bv=35" async="async"></script>
</div>

    </section>
    
  </div>
</aside>

      </div>
    </main>
   
    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  <span itemprop="copyrightYear">  &copy; 
  2009 - 2023</span>
</div>
<div>
  <a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">粤ICP备2021068940号-1</a>
  <a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011302003059" rel="noopener" target="_blank">粤公网安备44011302003059</a>
</div>


      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
      <span id="scrollpercent"><span>0</span>%</span>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>
<script type="text/javascript" src="http://shanks.link/js/vendor/jquery/index.js?v=2.1.3"></script>
<script type="text/javascript" src="http://shanks.link/js/vendor/fastclick/lib/fastclick.min.js?v=1.0.6"></script> 
<script type="text/javascript" src="http://shanks.link/js/vendor/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
<script type="text/javascript" src="http://shanks.link/js/vendor/velocity/velocity.min.js?v=1.2.1"></script>
<script type="text/javascript" src="http://shanks.link/js/vendor/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="http://shanks.link/js/vendor/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>

<script src="http://shanks.link/js/vendor/fancybox/jquery.fancybox.pack.js?v=2.1.5"></script>

<script type="text/javascript" src="http://shanks.link/js/utils.js"></script>
<script type="text/javascript" src="http://shanks.link/js/motion.js"></script>
<script type="text/javascript" src="http://shanks.link/js/affix.js"></script>
<script type="text/javascript" src="http://shanks.link/js/schemes/pisces.js"></script>

<script type="text/javascript" src="http://shanks.link/js/scrollspy.js"></script>
<script type="text/javascript" src="http://shanks.link/js/post-details.js"></script>
<script type="text/javascript" src="http://shanks.link/js/toc.js"></script>

<script type="text/javascript" src="http://shanks.link/js/bootstrap.js"></script>

<script type="text/javascript" src="http://shanks.link/js/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'] ],
      displayMath: [ ['$$','$$'] ],
      processEscapes: true
    },
    "HTML-CSS": { fonts: ["TeX"] }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML' async></script>
</body>
</html>